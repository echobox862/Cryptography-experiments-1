# Cryptography-experiments
现代密码学第一次实验

项目概述
本项目是一套密码学解密工具集合，包含 4 个核心 Python 脚本，分别实现不同加密场景的解密功能，覆盖流密码、维吉尼亚式重复密钥 XOR、SHA1 哈希暴力破解等经典密码学问题，适用于密码学学习、加密数据恢复等场景。
所有脚本均基于 Python 标准库开发，无需额外安装第三方依赖，核心逻辑遵循密码学基本原理（如异或运算、哈希碰撞、字母频率分析、汉明距离等），保证解密过程的可理解性和正确性。
文件清单与功能说明
文件名	核心功能	适用场景
1.1.py	流密码密文解密（基于多密文异或推导密钥）	已知多个流密码密文，推导密钥和解密目标密文
1.2.py	维吉尼亚式重复密钥 XOR 解密（枚举密钥长度）	未知密钥长度的重复密钥 XOR 加密数据解密
1.3.py	重复密钥 XOR 破解（汉明距离 + 字母频率评分）	基于统计分析的重复密钥 XOR 密文解密
1.4.py	SHA1 哈希暴力破解（字符组合 + 全排列）	已知 SHA1 哈希值，破解固定长度 / 字符集的密码
ciphertext.txt	密文文件（1.3.py的输入数据）	存储 base64 编码的重复密钥 XOR 密文
环境要求
Python 版本：3.6 及以上（兼容 Python 3.x 所有版本）
依赖库：所有脚本仅使用 Python 标准库（hashlib/itertools/base64/string/time），无需额外安装依赖，直接运行即可。
各脚本使用步骤
1. 1.1.py：流密码密文解密
功能逻辑
利用流密码 “密文 1 ^ 密文 2 = 明文 1 ^ 明文 2” 的特性，通过目标密文c与多个其他密文（c_list）异或，提取可打印字符线索，人工推导c的明文后反算密钥，最终解密目标密文c_8。
使用步骤
直接运行脚本：
bash
python 1.1.py
输出内容：
首先打印c与c_list各密文异或后的字符分布（用于人工推导明文）；
打印推导得到的密钥（十六进制形式）；
打印目标密文c_8的解密结果（明文）。
2. 1.2.py：维吉尼亚式重复密钥 XOR 解密
功能逻辑
枚举可能的密钥长度（1-13），按密钥位置将密文分组，筛选每组中 “异或后结果均为合法字符” 的密钥，确定实际密钥长度后，用每组第一个合法密钥解密整个密文。
使用步骤
直接运行脚本：
bash
python 1.2.py
输出内容：
打印实际密钥长度；
打印各位置的候选密钥列表（十进制）；
打印最终解密结果（明文）。
3. 1.3.py：重复密钥 XOR 破解（统计分析版）
功能逻辑
计算不同密钥长度的归一化汉明距离，筛选距离最小的 3 个候选长度；
对每个候选长度，按位置分组并爆破单字节密钥；
用字母频率评分筛选最可能的明文和密钥。
使用步骤
确保ciphertext.txt与脚本在同一目录（文件内已包含 base64 编码的密文）；
运行脚本：
bash
python 1.3.py
输出内容：
打印候选密钥长度列表（按汉明距离排序）；
打印最终密钥（字符串形式）；
打印密钥长度；
打印解密后的明文。
4. 1.4.py：SHA1 哈希暴力破解
功能逻辑
基于预设的 8 位字符集（每位 2 个可选字符），用itertools.product生成所有字符组合；
对每个组合进行全排列，生成所有可能的候选密码；
计算候选密码的 SHA1 哈希，与目标哈希比对，匹配则输出结果。
使用步骤
直接运行脚本：
bash
python 1.4.py
输出内容：
找到匹配密码后，打印密码明文；
打印破解耗时（精确到 6 位小数）；
找到后立即退出程序（避免多余计算）。
核心逻辑说明
1. 异或运算（XOR）
所有解密脚本的核心运算，满足以下特性：
异或可逆：a ^ b ^ b = a（密文 ^ 密钥 = 明文 → 明文 ^ 密钥 = 密文）；
相同为 0、不同为 1：用于字节级数据的加密 / 解密。
2. 汉明距离（1.3.py）
衡量两个字节序列的差异程度（不同位的数量），用于筛选重复密钥 XOR 的合理密钥长度 ——密钥长度越接近真实值，归一化汉明距离越小。
3. 字母频率分析（1.3.py）
基于英文文本中字符出现的固定频率（如e占比约 10.4%、空格占比约 19.2%），对解密结果评分，得分越高越可能是合法英文明文。
4. 暴力破解（1.4.py）
通过枚举所有可能的密码组合（字符组合 + 全排列），遍历哈希空间，适用于 “密码长度短、字符集已知” 的场景（本脚本针对 8 位固定字符集）。
注意事项
文件路径：1.3.py依赖ciphertext.txt，需确保两者在同一目录，否则会报 “文件不存在” 错误；
运行时间：1.4.py因涉及全排列（8 位字符的全排列数量为8! = 40320，且需遍历所有字符组合），运行时间可能较长（具体取决于设备性能）；
密文修改：若需解密自定义密文，需修改对应脚本中的密文变量（如1.1.py的c和c_list、1.2.py的ciphertext）；
哈希目标：1.4.py的目标 SHA1 哈希（TARGET_SHA1_HASH）可替换为自定义哈希值，但需同步修改POSITION_CHAR_OPTIONS（密码字符集）以匹配实际密码规则。
